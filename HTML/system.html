<!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="res/styles.css">
        <link rel="stylesheet" href="res/iconsfont.css">
		<script src="res/main.js"></script>
		<script src="res/res.js"></script>
        <title>~name~</title>
    </head>
    <body>
		<script>PageSurround();</script>
        <!--========== CONTENTS ==========-->
        <main>
            <section>
			<div class="ml">
			  
			  <div class="mlp">
				<div class="mlpc">
				 <form name="syst" method="post">
				<div class="mlhdr">SYSTEM</div>				  
				<table class='cntr'><script>PrintTextInputNoReg('Имя устройства:','nam','~dname~', 3, 31 );
				PrintTextInput('User name:','lgn','~login~', 3, 31 );
				PrintTextInput('User password:','psn','~pass~', 5, 31 );
				PrintCheckBox('Enable OTA update','ota','~ota~',null);</script></table>
				<table class='cntr'><tr><td align="center">Update firmware URL:</td></tr></table>
				<table class='cntr'><tr><td><textarea type="text"  raws="5" name='otaurl'  title="64 символа" ">~otaurl~</textarea></td></tr>
				</table>
				<table class='cntr'><script>
				PrintSep();
				PrintLabel('Device model:','~name~');
				PrintLabel('Firmware version:','~fver~');
				PrintLabel('IDF version:','~idfver~');
				PrintLabel('Built date:','~builddate~');
				PrintLabel('Serial number:','~serial10~');</script></table>
				<script>PrintSaveFail('~status_fail~');</script>
				<button type="submit" class ='btn' name='upd' value='prs'>Update manual</button>
				<button type="submit" class ='btn' name='rst' value='prs'>Reboot</button>
				<script>PrintSaveBtn('syst'); PrintApplyBtn('syst');</script>
				</form>
				</div>
			  </div>
			  
			  <div class="mlp">
				<div class="mlpc">
				<form name="stat" method="post">
				<div class="mlhdr">STAT</div>
				<table class='cntr'>
				<tr><td class='rl lab'>Ethernet:</td><td><span id='eth'>?</span></td></tr>
				<tr><td class='rl lab'>WiFi:</td><td><span id='wfi'>?</span></td></tr>
				<tr><td class='rl lab'>GPRS:</td><td><span id='gpr'>?</span></td></tr>
				<tr><td height='20px'></td></tr>
				<tr><td class='rl lab'>Current net adapter:</td><td><span id='adp'>?</span></td></tr>
				<tr><td height='20px'></td></tr>
				<tr><td class='rl lab'>MQTT connection 1:</td><td><span id='mq1'>?</span></td></tr>
				<tr><td class='rl lab'>MQTT connection 2:</td><td><span id='mq2'>?</span></td></tr>
				<tr><td height='20px'></td></tr>
				<tr><td class='rl lab'>Free RAM:</td><td><span id='mem'>?</span></td></tr>
				<tr><td class='rl lab'>Minimal free RAM :</td><td><span id='mmem'>?</span></td></tr>
				</table>
				</form>
				</div>
			  </div>
			  
			  <div class="mlp">
				<div class="mlpc">
				<div class="mlhdr">DEBUG</div>
				<div style='margin:auto;text-align:center'>
				</br>
				<button type="button" class ='btn' name='cmd1' onclick="cmd(1)">F1</button>
				<button type="button" class ='btn' name='cmd2' onclick="cmd(2)">F2</button></br></br>
				<button type="button" class ='btn' name='cmd3' onclick="cmd(3)">F3</button>
				<button type="button" class ='btn' name='cmd4' onclick="cmd(4)">F4</button></br></br>
				<button type="button" class ='btn' name='cmd5' onclick="cmd(5)">F5</button>
				<button type="button" class ='btn' name='cmd6' onclick="cmd(6)">F6</button></br></br>
				<button type="button" class ='btn' name='cmd7' onclick="cmd(7)">F7</button>
				<button type="button" class ='btn' name='cmd8' onclick="cmd(8)">F8</button></br></br>
				<button type="button" class ='btn' name='cmd9' onclick="cmd(9)">F9</button>
				<button type="button" class ='btn' name='cmd10' onclick="cmd(10)">F10</button></br></br>
				</div>
				</div>
			  </div>
			  
			</div>
			</section>			
        </main>
		<script>
		function cmd(n) 
			{
			  PostData("cmd="+n, "system.html",false ,false, false);
			}
		showMenu('header-toggle','navbar');
		</script>		
    </body>
    <script>
	function updateStatus(data) {
	var dat = JSON.parse(data);
	try
		{
		document.getElementById('eth').innerHTML= dat.ethstat;
		document.getElementById('wfi').innerHTML= dat.wfstat;
		document.getElementById('gpr').innerHTML= dat.gsmstat;
		document.getElementById('adp').innerHTML= dat.defadp;
		document.getElementById('mq1').innerHTML= dat.mqtt1st;
		document.getElementById('mq2').innerHTML= dat.mqtt2st;
		document.getElementById('mem').innerHTML= dat.freeram;
		document.getElementById('mmem').innerHTML= dat.minram;
		}
	catch(e){return;}
	}
	function ReadAndUpdate() {
	GetDataFile("/api/stat.json", function(data){updateStatus(data);});
	}
	ReadAndUpdate();
	setInterval("ReadAndUpdate()",1000);
	</script>
</html>